要理解文档中 **LEV（Levenshtein距离）、DTW（动态时间规整）、REC（复发度量）** 三个指标的计算方式，需结合**文档明确说明**、**指标通用定义**以及**360°图像扫描路径的特殊性**（球面坐标、时间序列特性）综合分析，具体计算逻辑如下：


### 一、共性前提：指标计算的统一框架
文档在 **4.2 实验设置-评估指标** 中明确了所有指标的基础计算逻辑，这是理解三者的前提：
1. **序列配对**：对某幅图像，生成与GT扫描路径数量相等的预测路径（\(\hat{N}=N\)），且预测路径长度与“人类观看时间一致”（1Hz采样，长度=观看秒数）；
2. **两两比较**：计算所有GT路径与预测路径的“两两组合”（共\(N×\hat{N}=N²\)对）的指标值；
3. **均值化**：对所有两两结果取平均，得到最终指标（如mLEV、mDTW、mREC），以减少随机偏差。

此外，360°图像的注视点以**3D球面坐标（\(x_t,y_t,z_t\)）** 表示，因此所有指标计算中涉及“注视点距离”时，均需采用**球面距离**（而非2D欧氏距离），避免赤道投影畸变的影响（文档中ScanGAN等模型也强调球面距离的重要性）。


### 二、各指标具体计算逻辑
#### 1. LEV（Levenshtein距离）：衡量序列的“编辑相似性”
LEV是自然语言处理和序列分析中常用的指标，核心是**将一个序列转换为另一个序列所需的最小编辑操作数**，文档中适配扫描路径的计算逻辑如下：

##### （1）基础定义（适配扫描路径）
对一对GT路径 \(x^i = (x_1^i, x_2^i, ..., x_T^i)\) 和预测路径 \(\tilde{x}^j = (\tilde{x}_1^j, \tilde{x}_2^j, ..., \tilde{x}_T^j)\)（长度均为T），LEV(\(x^i, \tilde{x}^j\)) 表示“将\(\tilde{x}^j\)调整为\(x^i\)所需的最小操作数”，操作类型仅包括：
- **插入**：在\(\tilde{x}^j\)中插入一个与\(x^i\)匹配的注视点；
- **删除**：删除\(\tilde{x}^j\)中与\(x^i\)不匹配的注视点；
- **替换**：将\(\tilde{x}^j\)中某注视点替换为\(x^i\)对应位置的注视点。

##### （2）关键适配：“匹配”的判定标准
由于扫描路径是**连续的注视点序列**（非离散字符），需定义“两个注视点是否匹配”：
- 计算两个3D球面坐标注视点（\(x_t^i\)和\(\tilde{x}_t^j\)）的**球面距离**（公式：\(d = \arccos(\sin\theta_1\sin\theta_2 + \cos\theta_1\cos\theta_2\cos\Delta\phi)\)，其中\(\theta\)为纬度、\(\phi\)为经度）；
- 设定一个**距离阈值**（文档未明确给出，但为领域常规操作）：若球面距离≤阈值，则判定两注视点“匹配”，无需编辑；否则判定“不匹配”，需执行插入/删除/替换操作。

##### （3）最终计算：均值化LEV（mLEV）
按文档公式（18），对所有两两组合的LEV值取平均：
\[mLEV = \frac{1}{N×N} \sum_{i=1}^N \sum_{j=1}^N LEV(x^i, \tilde{x}^j)\]
- 意义：mLEV越小，说明预测路径与GT路径的“编辑差异”越小，相似性越高。


#### 2. DTW（动态时间规整）：衡量序列的“时间对齐相似性”
DTW是时间序列分析中用于**对齐长度相近但时间偏移的序列**的指标，核心是通过“弹性拉伸/压缩时间轴”找到两序列的最优对齐方式，计算最小累积距离。文档中针对扫描路径的计算逻辑如下：

##### （1）基础定义（适配扫描路径）
对一对GT路径 \(x^i\) 和预测路径 \(\tilde{x}^j\)（长度均为T，因与观看时间一致，长度差异极小），DTW(\(x^i, \tilde{x}^j\)) 是“两序列最优对齐后的最小累积球面距离”，计算分3步：
1. **构建距离矩阵**：构建T×T的距离矩阵\(D\)，其中元素\(D(t_1,t_2)\)表示GT路径第\(t_1\)个注视点与预测路径第\(t_2\)个注视点的**球面距离**（同LEV中的距离计算）；
2. **寻找最优对齐路径**：从矩阵左上角（\(t_1=1,t_2=1\)）到右下角（\(t_1=T,t_2=T\)）寻找一条“累积距离最小”的路径，路径移动规则为：
   - 横向移动（\(t_1\)不变，\(t_2+1\)）：对应预测路径的时间拉伸；
   - 纵向移动（\(t_1+1\)，\(t_2\)不变）：对应GT路径的时间拉伸；
   - 对角线移动（\(t_1+1,t_2+1\)）：对应两序列时间同步；
3. **计算累积距离**：将最优路径上所有\(D(t_1,t_2)\)求和，即为该对序列的DTW值。

##### （2）360°场景适配：简化的时间对齐
文档中预测路径与GT路径“长度相等”（均等于观看时间），因此DTW无需处理“长度差异大”的情况，仅需对齐**细微的时间偏移**（如人类注视的微小时间延迟），计算复杂度更低，但核心逻辑（最小累积球面距离）不变。

##### （3）最终计算：均值化DTW（mDTW）
与LEV一致，对所有两两组合的DTW值取平均：
\[mDTW = \frac{1}{N×N} \sum_{i=1}^N \sum_{j=1}^N DTW(x^i, \tilde{x}^j)\]
- 意义：mDTW越小，说明预测路径与GT路径的“时间-空间对齐度”越高，动态一致性越好。


#### 3. REC（复发度量）：衡量序列的“重复模式相似性”
REC是行为研究中用于衡量**序列重复性/相似性**的指标，文档未直接给出公式，但结合引用文献[16,43]（行为研究方法）和“REC越高越好”的特性，可推断其计算逻辑围绕“扫描路径的复发事件重合度”展开：

##### （1）基础定义（参考领域共识）
“复发事件”指扫描路径中**注视点的重复行为**，例如：
- 同一空间区域的重复注视（如反复看向某 salient 物体）；
- 注视顺序的重复模式（如“注视A→注视B→再注视A”的循环）；
- 注视点间距/方向的重复规律。

REC的核心是**量化GT路径与预测路径中“复发事件”的重合程度**，重合度越高，REC值越大。

##### （2）具体计算步骤（适配扫描路径）
结合文档逻辑和文献[16,43]，REC的计算分3步：
1. **构建递归图（Recurrence Plot, RP）**：对GT路径\(x^i\)和预测路径\(\tilde{x}^j\)，分别绘制递归图——以时间为轴（横纵轴均为\(1→T\)），若某时刻\(t_1\)与\(t_2\)的注视点满足“球面距离≤阈值”（同LEV的匹配标准），则在RP上标记为“复发点”（黑色像素）；
2. **计算复发重合度**：将GT路径的RP与预测路径的RP叠加，统计“两图均为复发点”的像素数量，除以“两图总复发点数量”（或总时间步数量\(T×T\)），得到该对序列的REC值；
3. **均值化**：对所有两两组合的REC值取平均，得到mREC。

##### （3）意义
REC越高，说明预测路径不仅“空间上聚焦正确区域”，还“时间上复现了人类注视的重复模式”，动态行为更真实。


### 三、关键总结：360°场景下的指标计算核心差异
与2D图像的扫描路径指标相比，文档中三者的计算有一个**核心适配**：
所有涉及“注视点距离”的步骤（LEV的匹配判定、DTW的距离矩阵、REC的递归图构建）均采用**球面距离**，而非2D欧氏距离，以消除360°图像赤道投影畸变的影响，确保指标能真实反映球面空间中的注视相似性。

此外，三者的“均值化处理”（两两配对取平均）是文档明确要求的操作，目的是减少单一序列对比的随机性偏差，让指标更可靠。